<?xml version="1.0" encoding="UTF-8"?>
<doctrine-mongo-mapping xmlns="http://doctrine-project.org/schemas/odm/doctrine-mongo-mapping"
                        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                        xsi:schemaLocation="http://doctrine-project.org/schemas/odm/doctrine-mongo-mapping
                        http://doctrine-project.org/schemas/odm/doctrine-mongo-mapping.xsd">

    <document name="SOTB\CoreBundle\Document\Torrent" repository-class="SOTB\CoreBundle\Document\Repository\TorrentRepository" collection="Torrents">
        <field name="id" id="true"/>

        <field name="hash" fieldName="hash" type="string"/>
        <reference-many name="peers" fieldName="peers" field="peers" mapped-by="torrent"
                        target-document="SOTB\CoreBundle\Document\Peer">
        </reference-many>

        <reference-many name="activePeers" fieldName="activePeers" field="activePeers" mapped-by="torrent"
                        target-document="SOTB\CoreBundle\Document\Peer"
                        repository-method="findActivePeers">
            <sort>
                <sort field="expires" order="asc"/>
            </sort>
        </reference-many>

        <field name="name" fieldName="name" type="string"/>

        <field name="info" fieldName="info" type="hash"/>
        <field name="announceList" fieldName="announceList" type="hash"/>
        <field name="creationDate" fieldName="creationDate" type="date"/>
        <field name="comment" fieldName="comment" type="string"/>
        <field name="createdBy" fieldName="createdBy" type="string"/>
        <field name="encoding" fieldName="encoding" type="string"/>

        <field name="created" fieldName="created" type="date"/>

    </document>
</doctrine-mongo-mapping>